package lib.sintactico;

import analizador.ParseException;
import analizador.Token;
import analizador.minilengcompiler;
import analizador.minilengcompilerConstants;

public class PanicMode implements minilengcompilerConstants {
	
	private static int contadorErrores = 0;
	
	
	public static void iniciar(ParseException e, String mensaje, int tipoToken, String tokenLiteral) {
		contadorErrores++;
		
		System.err.println("MiniLeng: ERROR SINTÁCTICO (línea " + e.currentToken.next.beginLine +
				", columna " + (e.currentToken.next.beginColumn) + "): Token incorrecto: '" +
                e.currentToken.next + "'. " + mensaje);
		
		System.err.println("PANIC MODE: Iniciado panic mode");
		
		
		// Descarta la entrada hasta encontrar un token de tipo tipoToken
		
		Token t = minilengcompiler.getNextToken();
		while(t.kind != tipoToken && t.kind != EOF) {
			System.out.println("> PANIC MODE: Token descartado: " + t.image);
			t = minilengcompiler.getNextToken();
		}

		
		if (t.kind == EOF) {
			System.out.println("> PANIC MODE (línea " + t.next.beginLine + 
					", columna " + (e.currentToken.next.beginColumn) + "): Fila, columna: Se ha terminado el fichero");
		}
		
		else {
			System.out.println("> PANIC MODE (línea " + t.next.beginLine + 
					", columna " + (e.currentToken.next.beginColumn) + 
					"): Fila, columna: Se ha encontrado '" + tokenLiteral + "'");
		}
		
		
		System.err.println("PANIC MODE: Terminado panic mode");
	}
	
	
	public static int getContadorErrores() {
		return contadorErrores;
	}
}
